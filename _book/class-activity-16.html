<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 22 Class Activity 16 | Stat 220 Introduction to Data Science</title>
<meta name="author" content="Deepak Bastola">
<meta name="description" content="# load the necessary libraries library(tidyverse) library(stringr) library(polite) library(rvest)  22.1 Group Activity 1  22.1.1 a. Scrape the first table in List_of_NASA_missions wiki page....">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="Chapter 22 Class Activity 16 | Stat 220 Introduction to Data Science">
<meta property="og:type" content="book">
<meta property="og:description" content="# load the necessary libraries library(tidyverse) library(stringr) library(polite) library(rvest)  22.1 Group Activity 1  22.1.1 a. Scrape the first table in List_of_NASA_missions wiki page....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 22 Class Activity 16 | Stat 220 Introduction to Data Science">
<meta name="twitter:description" content="# load the necessary libraries library(tidyverse) library(stringr) library(polite) library(rvest)  22.1 Group Activity 1  22.1.1 a. Scrape the first table in List_of_NASA_missions wiki page....">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!--
    <script>
    document.addEventListener('DOMContentLoaded', function () {
      const headers = document.querySelectorAll('.book .book-body h1, .book .book-body h2, .book .book-body h3');
      const tocLinks = document.querySelectorAll('.book .book-body .tocify .tocify-item a');
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              const id = entry.target.getAttribute('id');
              const link = Array.from(tocLinks).find((link) => link.getAttribute('href').endsWith('#' + id));
              if (link) {
                tocLinks.forEach((l) => l.classList.remove('active'));
                link.classList.add('active');
              }
            }
          });
        },
        { threshold: 0.5 }
      );

      headers.forEach((header) => observer.observe(header));
    });
    </script>

    --><meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Stat 220 Introduction to Data Science</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Course overview</a></li>
<li class="book-part">Set-up Instructions</li>
<li><a class="" href="rstudio.html"><span class="header-section-number">1</span> What is R, RStudio, and RMarkdown?</a></li>
<li><a class="" href="assignments.html"><span class="header-section-number">2</span> Assignments in Stat 220</a></li>
<li><a class="" href="software.html"><span class="header-section-number">3</span> Software in Stat 220</a></li>
<li><a class="" href="github.html"><span class="header-section-number">4</span> GitHub Guide for Students in Stat 220</a></li>
<li><a class="" href="r-markdown-syntax.html"><span class="header-section-number">5</span> R Markdown Syntax</a></li>
<li><a class="" href="github-tutorial.html"><span class="header-section-number">6</span> Github Tutorial</a></li>
<li class="book-part">Class Activities</li>
<li><a class="" href="class-activity-1.html"><span class="header-section-number">7</span> Class Activity 1</a></li>
<li><a class="" href="class-activity-2.html"><span class="header-section-number">8</span> Class Activity 2</a></li>
<li><a class="" href="class-activity-3.html"><span class="header-section-number">9</span> Class Activity 3</a></li>
<li><a class="" href="class-activity-4.html"><span class="header-section-number">10</span> Class Activity 4</a></li>
<li><a class="" href="class-activity-5.html"><span class="header-section-number">11</span> Class Activity 5</a></li>
<li><a class="" href="class-activity-6.html"><span class="header-section-number">12</span> Class Activity 6</a></li>
<li><a class="" href="class-activity-7.html"><span class="header-section-number">13</span> Class Activity 7</a></li>
<li><a class="" href="class-activity-8.html"><span class="header-section-number">14</span> Class Activity 8</a></li>
<li><a class="" href="class-activity-9.html"><span class="header-section-number">15</span> Class Activity 9</a></li>
<li><a class="" href="class-activity-10.html"><span class="header-section-number">16</span> Class Activity 10</a></li>
<li><a class="" href="class-activity-11.html"><span class="header-section-number">17</span> Class Activity 11</a></li>
<li><a class="" href="class-activity-12.html"><span class="header-section-number">18</span> Class Activity 12</a></li>
<li><a class="" href="class-activity-13.html"><span class="header-section-number">19</span> Class Activity 13</a></li>
<li><a class="" href="class-activity-14.html"><span class="header-section-number">20</span> Class Activity 14</a></li>
<li><a class="" href="class-activity-15.html"><span class="header-section-number">21</span> Class Activity 15</a></li>
<li><a class="active" href="class-activity-16.html"><span class="header-section-number">22</span> Class Activity 16</a></li>
<li><a class="" href="class-activity-17.html"><span class="header-section-number">23</span> Class Activity 17</a></li>
<li><a class="" href="class-activity-18.html"><span class="header-section-number">24</span> Class Activity 18</a></li>
<li><a class="" href="class-activity-19.html"><span class="header-section-number">25</span> Class Activity 19</a></li>
<li><a class="" href="class-activity-20.html"><span class="header-section-number">26</span> Class Activity 20</a></li>
<li><a class="" href="class-activity-21.html"><span class="header-section-number">27</span> Class Activity 21</a></li>
<li><a class="" href="class-activity-22.html"><span class="header-section-number">28</span> Class Activity 22</a></li>
<li><a class="" href="class-activity-23.html"><span class="header-section-number">29</span> Class Activity 23</a></li>
<li><a class="" href="class-activity-24.html"><span class="header-section-number">30</span> Class Activity 24</a></li>
<li><a class="" href="class-activity-25.html"><span class="header-section-number">31</span> Class Activity 25</a></li>
<li><a class="" href="class-activity-27.html"><span class="header-section-number">32</span> Class Activity 27</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="class-activity-16" class="section level1" number="22">
<h1>
<span class="header-section-number">22</span> Class Activity 16<a class="anchor" aria-label="anchor" href="#class-activity-16"><i class="fas fa-link"></i></a>
</h1>
<div class="sourceCode" id="cb406"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load the necessary libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmi3kno/polite">polite</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rvest.tidyverse.org/">rvest</a></span><span class="op">)</span></span></code></pre></div>
<div id="group-activity-1-3" class="section level2" number="22.1">
<h2>
<span class="header-section-number">22.1</span> Group Activity 1<a class="anchor" aria-label="anchor" href="#group-activity-1-3"><i class="fas fa-link"></i></a>
</h2>
<div id="a.-scrape-the-first-table-in-list_of_nasa_missions-wiki-page.-additionally-use-janitorclean_names-to-clean-the-column-names-and-store-the-resulting-table-as-nasa_missions.csv-in-your-working-folder." class="section level3" number="22.1.1">
<h3>
<span class="header-section-number">22.1.1</span> a. Scrape the first table in <code>List_of_NASA_missions</code> wiki page. Additionally, use <code>janitor::clean_names()</code> to clean the column names and store the resulting table as <code>NASA_missions.csv</code> in your working folder.<a class="anchor" aria-label="anchor" href="#a.-scrape-the-first-table-in-list_of_nasa_missions-wiki-page.-additionally-use-janitorclean_names-to-clean-the-column-names-and-store-the-resulting-table-as-nasa_missions.csv-in-your-working-folder."><i class="fas fa-link"></i></a>
</h3>
<details><summary class="answer">
Click for answer
</summary><div class="sourceCode" id="cb407"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wiki_NASA</span> <span class="op">&lt;-</span> <span class="st">"https://en.wikipedia.org/wiki/List_of_NASA_missions"</span></span>
<span></span>
<span><span class="co"># Scrape the data and write the first table to a CSV file</span></span>
<span><span class="fu"><a href="https://dmi3kno.github.io/polite/reference/bow.html">bow</a></span><span class="op">(</span><span class="va">wiki_NASA</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dmi3kno.github.io/polite/reference/scrape.html">scrape</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/rename.html">html_nodes</a></span><span class="op">(</span><span class="st">"table"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="va">.</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_table.html">html_table</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span><span class="st">"NASA_missions.csv"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div id="b.-now-write-a-code-snippet-to-scrape-all-the-urls-from-the-anchor-tags-on-a-given-wikipedia-page-convert-the-relative-urls-to-absolute-urls-and-store-the-results-in-a-tibble-and-save-it-as-nasa_missions_urls.csv-in-your-working-folder." class="section level3" number="22.1.2">
<h3>
<span class="header-section-number">22.1.2</span> b. Now, write a code snippet to scrape all the URLs from the anchor tags (<a>) on a given Wikipedia page, convert the relative URLs to absolute URLs, and store the results in a tibble and save it as <code>NASA_missions_urls.csv</code> in your working folder.</a><a class="anchor" aria-label="anchor" href="#b.-now-write-a-code-snippet-to-scrape-all-the-urls-from-the-anchor-tags-on-a-given-wikipedia-page-convert-the-relative-urls-to-absolute-urls-and-store-the-results-in-a-tibble-and-save-it-as-nasa_missions_urls.csv-in-your-working-folder."><i class="fas fa-link"></i></a>
</h3>
<details><summary class="answer">
Click for answer
</summary><div class="sourceCode" id="cb408"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Scrape the data and write the URLs to a CSV file</span></span>
<span><span class="fu"><a href="https://dmi3kno.github.io/polite/reference/bow.html">bow</a></span><span class="op">(</span><span class="va">wiki_NASA</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dmi3kno.github.io/polite/reference/scrape.html">scrape</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/rename.html">html_nodes</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_attr.html">html_attr</a></span><span class="op">(</span><span class="st">"href"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="http://xml2.r-lib.org/reference/url_absolute.html">url_absolute</a></span><span class="op">(</span><span class="st">"https://en.wikipedia.org/"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>url <span class="op">=</span> <span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span><span class="st">"NASA_missions_urls.csv"</span><span class="op">)</span> </span></code></pre></div>
</details><hr>
</div>
</div>
<div id="group-activity-2-3" class="section level2" number="22.2">
<h2>
<span class="header-section-number">22.2</span> Group Activity 2<a class="anchor" aria-label="anchor" href="#group-activity-2-3"><i class="fas fa-link"></i></a>
</h2>
<div id="a.-how-do-you-scrape-a-table-from-a-web-page-using-rvest-clean-the-column-names-with-janitor-and-prepare-the-data-for-analysis-in-r" class="section level3" number="22.2.1">
<h3>
<span class="header-section-number">22.2.1</span> a. How do you scrape a table from a web page using <code>rvest</code>, clean the column names with <code>janitor</code>, and prepare the data for analysis in R?<a class="anchor" aria-label="anchor" href="#a.-how-do-you-scrape-a-table-from-a-web-page-using-rvest-clean-the-column-names-with-janitor-and-prepare-the-data-for-analysis-in-r"><i class="fas fa-link"></i></a>
</h3>
<details><summary class="answer">
Click for answer
</summary><div class="sourceCode" id="cb409"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">yf</span> <span class="op">&lt;-</span> <span class="st">"https://finance.yahoo.com/quote/CL%3DF/history?p=CL%3DF"</span></span>
<span>  <span class="fu"><a href="https://dmi3kno.github.io/polite/reference/bow.html">bow</a></span><span class="op">(</span><span class="va">yf</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dmi3kno.github.io/polite/reference/scrape.html">scrape</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rvest.tidyverse.org/reference/rename.html">html_nodes</a></span><span class="op">(</span><span class="st">"table"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_table.html">html_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">open</span><span class="op">:</span><span class="va">adj_close</span><span class="op">)</span>, <span class="va">as.numeric</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">ticker</span></span></code></pre></div>
</details>
</div>
<div id="b.-write-the-r-code-to-create-a-time-trend-plot-of-opening-prices-from-the-scraped-data-using-ggplot2." class="section level3" number="22.2.2">
<h3>
<span class="header-section-number">22.2.2</span> b. Write the R code to create a time trend plot of opening prices from the scraped data using <code>ggplot2.</code><a class="anchor" aria-label="anchor" href="#b.-write-the-r-code-to-create-a-time-trend-plot-of-opening-prices-from-the-scraped-data-using-ggplot2."><i class="fas fa-link"></i></a>
</h3>
<details><summary class="answer">
Click for answer
</summary><div class="sourceCode" id="cb410"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">ticker</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">open</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Plot lines</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Add points</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>date_labels <span class="op">=</span> <span class="st">"%b %d, %Y"</span>, date_breaks <span class="op">=</span> <span class="st">"1 week"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Time Trend of Opening Prices"</span>, x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Opening Price"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="inline-figure"><img src="class_activity_16_files/figure-html/unnamed-chunk-5-1.png" width="100%"></div>
</details>
</div>
<div id="c.-how-can-you-transform-the-data-into-a-long-format-suitable-for-plotting-multiple-price-types-with-ggplot2" class="section level3" number="22.2.3">
<h3>
<span class="header-section-number">22.2.3</span> c. How can you transform the data into a long format suitable for plotting multiple price types with <code>ggplot2</code>?<a class="anchor" aria-label="anchor" href="#c.-how-can-you-transform-the-data-into-a-long-format-suitable-for-plotting-multiple-price-types-with-ggplot2"><i class="fas fa-link"></i></a>
</h3>
<details><summary class="answer">
Click for answer
</summary><div class="sourceCode" id="cb411"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ticker_long</span> <span class="op">&lt;-</span> <span class="va">ticker</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">open</span>, <span class="va">close</span>, <span class="va">adj_close</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"PriceType"</span>, values_to <span class="op">=</span> <span class="st">"Price"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div id="d.-show-how-to-create-a-ggplot2-visualization-that-includes-lines-and-points-with-different-colors-and-shapes-for-each-price-type-and-make-the-x-axis-dates-legible." class="section level3" number="22.2.4">
<h3>
<span class="header-section-number">22.2.4</span> d. Show how to create a <code>ggplot2</code> visualization that includes lines and points, with different colors and shapes for each price type, and make the x-axis dates legible.<a class="anchor" aria-label="anchor" href="#d.-show-how-to-create-a-ggplot2-visualization-that-includes-lines-and-points-with-different-colors-and-shapes-for-each-price-type-and-make-the-x-axis-dates-legible."><i class="fas fa-link"></i></a>
</h3>
<details><summary class="answer">
Click for answer
</summary><div class="sourceCode" id="cb412"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">ticker_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">Price</span>, color <span class="op">=</span> <span class="va">PriceType</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">PriceType</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Different shapes for each price type</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"open"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"close"</span> <span class="op">=</span> <span class="st">"green"</span>, <span class="st">"adj_close"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>date_labels <span class="op">=</span> <span class="st">"%b %d, %Y"</span>, date_breaks <span class="op">=</span> <span class="st">"1 week"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Time Trend of Stock Prices"</span>, x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Price"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Price Type"</span><span class="op">)</span>, color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Price Type"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="class_activity_16_files/figure-html/unnamed-chunk-7-1.png" width="100%"></div>
</details><hr>
</div>
</div>
<div id="group-activity-3-1" class="section level2" number="22.3">
<h2>
<span class="header-section-number">22.3</span> Group Activity 3<a class="anchor" aria-label="anchor" href="#group-activity-3-1"><i class="fas fa-link"></i></a>
</h2>
<p>In this activity, you’ll scrape web data using <code>rvest</code> and tidy up the results into a well-formatted table. Start by extracting job titles from a given URL, then gather the associated company names, and trim any leading or trailing whitespace from the location data. Next, retrieve the posting dates and the URLs for the full job descriptions. Finally, combine all these elements into a single dataframe, ensuring that each piece of information aligns correctly. Your task is to produce a clean and informative table that could be useful for job seekers. To facilitate the selection of the correct CSS selectors, you may find the <code>SelectorGadget</code> Chrome extension particularly useful.</p>
<div class="sourceCode" id="cb413"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://realpython.github.io/fake-jobs/"</span></span></code></pre></div>
<details><summary class="answer">
Click for answer
</summary><div class="sourceCode" id="cb414"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dmi3kno.github.io/polite/reference/bow.html">bow</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dmi3kno.github.io/polite/reference/scrape.html">scrape</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span>css <span class="op">=</span> <span class="st">".is-5"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text</a></span><span class="op">(</span><span class="op">)</span>   <span class="co"># part 1</span></span>
<span><span class="va">company</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dmi3kno.github.io/polite/reference/bow.html">bow</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dmi3kno.github.io/polite/reference/scrape.html">scrape</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span>css <span class="op">=</span> <span class="st">".company"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># part 2</span></span>
<span><span class="va">location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dmi3kno.github.io/polite/reference/bow.html">bow</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dmi3kno.github.io/polite/reference/scrape.html">scrape</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span>css <span class="op">=</span> <span class="st">".location"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_trim.html">str_trim</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># part 3</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dmi3kno.github.io/polite/reference/bow.html">bow</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dmi3kno.github.io/polite/reference/scrape.html">scrape</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span>css <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># part 4</span></span>
<span><span class="va">html</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dmi3kno.github.io/polite/reference/bow.html">bow</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dmi3kno.github.io/polite/reference/scrape.html">scrape</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element</a></span><span class="op">(</span>css <span class="op">=</span> <span class="st">".card-footer-item+ .card-footer-item"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_attr.html">html_attr</a></span><span class="op">(</span><span class="st">"href"</span><span class="op">)</span>  <span class="co"># part 5</span></span>
<span></span>
<span><span class="co"># Create a dataframe</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">title</span>, company <span class="op">=</span> <span class="va">company</span>, location <span class="op">=</span> <span class="va">location</span>, time <span class="op">=</span> <span class="va">time</span>, html <span class="op">=</span> <span class="va">html</span><span class="op">)</span> <span class="co"># port 6</span></span></code></pre></div>
<pre><code># A tibble: 100 × 5
   title                     company    location time  html 
   &lt;chr&gt;                     &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;
 1 Senior Python Developer   Payne, Ro… Stewart… 2021… http…
 2 Energy engineer           Vasquez-D… Christo… 2021… http…
 3 Legal executive           Jackson, … Port Er… 2021… http…
 4 Fitness centre manager    Savage-Br… East Se… 2021… http…
 5 Product manager           Ramirez I… North J… 2021… http…
 6 Medical technical officer Rogers-Ya… Davidvi… 2021… http…
 7 Physiological scientist   Kramer-Kl… South C… 2021… http…
 8 Textile designer          Meyers-Jo… Port Jo… 2021… http…
 9 Television floor manager  Hughes-Wi… Osborne… 2021… http…
10 Waste management officer  Jones, Wi… Scottto… 2021… http…
# ℹ 90 more rows</code></pre>
</details>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="class-activity-15.html"><span class="header-section-number">21</span> Class Activity 15</a></div>
<div class="next"><a href="class-activity-17.html"><span class="header-section-number">23</span> Class Activity 17</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#class-activity-16"><span class="header-section-number">22</span> Class Activity 16</a></li>
<li>
<a class="nav-link" href="#group-activity-1-3"><span class="header-section-number">22.1</span> Group Activity 1</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#a.-scrape-the-first-table-in-list_of_nasa_missions-wiki-page.-additionally-use-janitorclean_names-to-clean-the-column-names-and-store-the-resulting-table-as-nasa_missions.csv-in-your-working-folder."><span class="header-section-number">22.1.1</span> a. Scrape the first table in List_of_NASA_missions wiki page. Additionally, use janitor::clean_names() to clean the column names and store the resulting table as NASA_missions.csv in your working folder.</a></li>
<li><a class="nav-link" href="#b.-now-write-a-code-snippet-to-scrape-all-the-urls-from-the-anchor-tags-on-a-given-wikipedia-page-convert-the-relative-urls-to-absolute-urls-and-store-the-results-in-a-tibble-and-save-it-as-nasa_missions_urls.csv-in-your-working-folder."><span class="header-section-number">22.1.2</span> b. Now, write a code snippet to scrape all the URLs from the anchor tags () on a given Wikipedia page, convert the relative URLs to absolute URLs, and store the results in a tibble and save it as NASA_missions_urls.csv in your working folder.</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#group-activity-2-3"><span class="header-section-number">22.2</span> Group Activity 2</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#a.-how-do-you-scrape-a-table-from-a-web-page-using-rvest-clean-the-column-names-with-janitor-and-prepare-the-data-for-analysis-in-r"><span class="header-section-number">22.2.1</span> a. How do you scrape a table from a web page using rvest, clean the column names with janitor, and prepare the data for analysis in R?</a></li>
<li><a class="nav-link" href="#b.-write-the-r-code-to-create-a-time-trend-plot-of-opening-prices-from-the-scraped-data-using-ggplot2."><span class="header-section-number">22.2.2</span> b. Write the R code to create a time trend plot of opening prices from the scraped data using ggplot2.</a></li>
<li><a class="nav-link" href="#c.-how-can-you-transform-the-data-into-a-long-format-suitable-for-plotting-multiple-price-types-with-ggplot2"><span class="header-section-number">22.2.3</span> c. How can you transform the data into a long format suitable for plotting multiple price types with ggplot2?</a></li>
<li><a class="nav-link" href="#d.-show-how-to-create-a-ggplot2-visualization-that-includes-lines-and-points-with-different-colors-and-shapes-for-each-price-type-and-make-the-x-axis-dates-legible."><span class="header-section-number">22.2.4</span> d. Show how to create a ggplot2 visualization that includes lines and points, with different colors and shapes for each price type, and make the x-axis dates legible.</a></li>
</ul>
</li>
<li><a class="nav-link" href="#group-activity-3-1"><span class="header-section-number">22.3</span> Group Activity 3</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/class_activity_16.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/class_activity_16.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Stat 220 Introduction to Data Science</strong>" was written by Deepak Bastola. It was last built on 2024-03-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
